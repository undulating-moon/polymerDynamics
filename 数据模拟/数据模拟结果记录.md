

# 数据模拟结果记录

## 测试

### wfbm_Randomness_test 验证随机函数wfbm的随机性

这一部分进行简要测试，我们首先要了解清楚wfbm函数的性质

#### fractional Brownian motion signal (fBm) of parameter H 理论概念

#### testing by Scrip 脚本测试

初始位置为
$$
x(0)=0\\
\sigma_v(0)=\frac{k_BT}{m}
a(0)=0
$$


在100，1000次实验取平均后，得到的效果不甚理想。但是在1w次后，MSR已经开始明显正比于时间，但是平均位移仍然有些偏差。

下面给出10w次实验取平均的结果。（H=0.5）

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\wfbm_Randomness_test_average_x.png" style="zoom: 50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\wfbm_Randomness_test_RMS.png" style="zoom: 50%;" />

### GLEcustom_v1_normal_diffusion 验证正常的扩散定律

这一部分验证程序基础逻辑本身可靠性，先从正常扩散开始，使用的非历史项而是正常的粘滞阻力，并且删除中心势
$$
m \frac{d v(t)}{d t}=-\zeta v(t)+\sqrt{2 \zeta k_{B} T} d B_{H}(t) / d t\\
a(t+\Delta  t)=-\frac{\zeta}{m}v(t)+\frac{\sqrt{2 \zeta k_{B} T}}{m} \frac{B_H(t+\Delta t)-B_{H}(t)}{\Delta t}\\
v(t+\Delta t)=v(t)+a(t)\Delta t\\
x(t+\Delta t)=x(t)+v(t)\Delta  t
$$
所有参数取1，并0.01秒进行一次模拟，共10秒，我们同上进行10w次实验，得到以下的图表情况（H=0.5）

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v1_normal_diffusion_average.png" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v1_normal_diffusion_RMS.png" style="zoom:50%;" />

实际上，与上文中wfbm生成的比较，这个算法实际上造成了较大的误差。

因此我们提高实验次数再来一次，100w次得到的结果（H=0.5）
<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v1_normal_diffusion_average'.png" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v1_normal_diffusion_RMS'.png" style="zoom:50%;" />

实际上我们发现，得到的RMS差距不大，总平均值反而更小

### GLEcustom_v2_diffusion_with_potential 加入中心势

我们测试一下加入中心势场之后的情况
$$
m \frac{d v(t)}{d t}=-\zeta v(t)-m\psi\cdot x(t) +\sqrt{2 \zeta k_{B} T} d B_{H}(t) / d t\\
a(t+\Delta  t)=-\frac{\zeta}{m}v(t)-\psi\cdot x(t)+\frac{\sqrt{2 \zeta k_{B} T}}{m} \frac{B_H(t+\Delta t)-B_{H}(t)}{\Delta t}\\
v(t+\Delta t)=v(t)+a(t)\Delta t\\
x(t+\Delta t)=x(t)+v(t)\Delta  t
$$
我们实际上看到这个方程得出的结果并没有能够很好地得到反常扩散图样（H=0.5）

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v2_normal_diffusion_with_potential_average.png" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v2_normal_diffusion_with_potential_RMS.png" style="zoom:50%;" />

看上去显然不符合反常扩散和正常扩散，可以说在t较小时候仍然为正常的扩散，而有心势的加入增加了一个上界。

### GLEcustom_v3_subdiffusion 加入历史项

当然，如果需要真正进行反常扩散的实验，我们肯定要加入代表历史的卷积，而非简单用

#### 理论推导

$$
m \frac{d v(t)}{d t}=-\zeta \int_{-\infty}^{t} K_{H}(t-u) v(u) d u-m\psi \cdot x(t)+\sqrt{2 \zeta k_{B} T} d B_{H}(t) / d t
$$

在这里我们要改写这个式子，将积分化为求和，并仅考虑$t>0$​时候的历史（$H\neq 0.5$）
$$
i=t/\Delta t\\
a(t+\Delta  t)=-\frac{\zeta}{m}\sum_{k=0}^{i-1}2H\cdot(2H-1)\cdot(i\cdot\Delta t-k\cdot\Delta t)^{2H-2}\cdot v(k\cdot\Delta t)\\-\psi\cdot x(t)+\frac{\sqrt{2 \zeta k_{B} T}}{m} \frac{B_H(t+\Delta t)-B_{H}(t)}{\Delta t}\\
v(t+\Delta t)=v(t)+a(t)\Delta t\\
x(t+\Delta t)=x(t)+v(t)\Delta  t
$$



#### 不加入有心势能

我们先进行饰演，考虑正常的反常扩散

以下是H=0.7，试验数为1000时的反常扩散曲线，可以看到，加入历史项后RMS波动变大，且平均位置震荡较多，但是幅度较小。当然，这是经过参数调整后的情况，取$\zeta=100$，否则难以得到趋势正确的反常扩散函数。

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v3.no_potential.0.7.average.png" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v3.no_potential.0.7.RMS.png" style="zoom:50%;" />

其余参数的测试由于电脑运行速度，未能完成

#### 加入有心势

以下是是H=0.7，试验数为1000时的反常扩散曲线，可以看到，加入历史项后RMS波动变大，且平均位置震荡较多，但是幅度较小。仍然取$\zeta=100$​，且取$\psi=1$

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v3.with_potential1.0.7.average.png" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v3.with_potential1.0.7.RMS.png" style="zoom:50%;" />

我们加大有心势的影响，取$\psi=10$​

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v3.with_potential10.0.7.average.png" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v3.with_potential10.0.7.RMS.png" style="zoom:50%;" />

继续加大有心势的影响，取$\psi=100$​

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v3.with_potential100.0.7.average.png" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\image\v3.with_potential100.0.7.RMS.png" style="zoom:50%;" />



其余参数的测试由于电脑运行速度，未能完成



## 进行参数模拟（暂时不考虑物理参量）

### GLEcustom_v4_subdiffusion_with_fuction 进行函数封装

我们进行了$\Delta t=0.1,0.01$情况下的模拟。

我们注意到当$\zeta$​​较大时候，会出现不符合我们需求的扩散物理图象的情况

下五图为$\Delta t=0.01$情况

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.01\RMS.zeta=400.psi=320.N=5000.jpg" alt="RMS.zeta=400.psi=320.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.01\RMS.zeta=400.psi=20.N=5000.jpg" alt="RMS.zeta=400.psi=20.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.01\RMS.zeta=400.psi=40.N=5000.jpg" alt="RMS.zeta=400.psi=40.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.01\RMS.zeta=400.psi=80.N=5000.jpg" alt="RMS.zeta=400.psi=80.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.01\RMS.zeta=400.psi=160.N=5000.jpg" alt="RMS.zeta=400.psi=160.N=5000" style="zoom:25%;" />

下图为$\Delta t=0.1$​​情况

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=5.psi=4.N=5000.jpg" alt="RMS.zeta=5.psi=4.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=40.psi=32.N=5000.jpg" alt="RMS.zeta=40.psi=32.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=10.psi=4.N=5000.jpg" alt="RMS.zeta=10.psi=4.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=10.psi=8.N=5000.jpg" alt="RMS.zeta=10.psi=8.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=20.psi=1.N=5000.jpg" alt="RMS.zeta=20.psi=1.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=20.psi=2.N=5000.jpg" alt="RMS.zeta=20.psi=2.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=20.psi=4.N=5000.jpg" alt="RMS.zeta=20.psi=4.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=20.psi=8.N=5000.jpg" alt="RMS.zeta=20.psi=8.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=20.psi=16.N=5000.jpg" alt="RMS.zeta=20.psi=16.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=40.psi=2.N=5000.jpg" alt="RMS.zeta=40.psi=2.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=40.psi=4.N=5000.jpg" alt="RMS.zeta=40.psi=4.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=40.psi=8.N=5000.jpg" alt="RMS.zeta=40.psi=8.N=5000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=40.psi=16.N=5000.jpg" alt="RMS.zeta=40.psi=16.N=5000" style="zoom:25%;" />

### GLEcustom_v5_data_plotting_v1 进行函数图象的处理

我们将$\zeta$相同的曲线放在一张图内

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=1.25, delta=0.1.png" alt="v5_RMS, zeta=1.25, delta=0.1" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=2.5, delta=0.1.png" alt="v5_RMS, zeta=2.5, delta=0.1" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=5, delta=0.1.png" alt="v5_RMS, zeta=5, delta=0.1" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=10, delta=0.1.png" alt="v5_RMS, zeta=10, delta=0.1" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=12.5, delta=0.01.png" alt="v5_RMS, zeta=12.5, delta=0.01" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=25, delta=0.01.png" alt="v5_RMS, zeta=25, delta=0.01" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=50, delta=0.01.png" alt="v5_RMS, zeta=50, delta=0.01" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=100, delta=0.01.png" alt="v5_RMS, zeta=100, delta=0.01" style="zoom:50%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=200, delta=0.01.png" alt="v5_RMS, zeta=200, delta=0.01" style="zoom:50%;" />

特别值得注意的是如下参数组

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=5, delta=0.1.png" alt="v5_RMS, zeta=5, delta=0.1" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=5.psi=4.N=5000.jpg" alt="RMS.zeta=5.psi=4.N=5000" style="zoom: 45%;" />

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v5image\v5_RMS, zeta=10, delta=0.1.png" alt="v5_RMS, zeta=10, delta=0.1" style="zoom:50%;" />

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=10.psi=4.N=5000.jpg" alt="RMS.zeta=10.psi=4.N=5000" style="zoom: 40%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4image\delta=0.1\RMS.zeta=10.psi=8.N=5000.jpg" alt="RMS.zeta=10.psi=8.N=5000" style="zoom: 40%;" />

溢出可能原因：

- 历史项处理问题
- 随机项问题
- 编程底层逻辑问题（加速度等）
- H参数调整问题

## 溢出原因探究

### GLEcustom_v6_test_for_explosion 利用RMS测试

#### 取中心势能为0观察

在$\zeta=340-350$左右时候，开始出现爆炸现象

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=340.psi=0.N=20.jpg" alt="RMS.zeta=340.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=341.psi=0.N=20.jpg" alt="RMS.zeta=341.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=342.psi=0.N=20.jpg" alt="RMS.zeta=342.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=343.psi=0.N=20.jpg" alt="RMS.zeta=343.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=344.psi=0.N=20.jpg" alt="RMS.zeta=344.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=345.psi=0.N=20.jpg" alt="RMS.zeta=345.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=346.psi=0.N=20.jpg" alt="RMS.zeta=346.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=347.psi=0.N=20.jpg" alt="RMS.zeta=347.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=348.psi=0.N=20.jpg" alt="RMS.zeta=348.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=349.psi=0.N=20.jpg" alt="RMS.zeta=349.psi=0.N=20" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=350.psi=0.N=20.jpg" alt="RMS.zeta=350.psi=0.N=20" style="zoom:25%;" />

#### 取$\zeta$​​为300，调节中心势大小观察

大约在120左右会溢出
<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=300.psi=110.N=20.jpg" alt="RMS.zeta=300.psi=90.N=20" style="zoom: 33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=300.psi=115.N=20.jpg" alt="RMS.zeta=300.psi=100.N=20" style="zoom: 33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=300.psi=120.N=20.jpg" alt="RMS.zeta=300.psi=120.N=20" style="zoom: 33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=300.psi=125.N=20.jpg" alt="RMS.zeta=300.psi=140.N=20" style="zoom: 33%;" />

#### 取$\zeta$​​​为250，调节中心势大小观察

大约在220左右开始溢出

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=250.psi=200.N=20.jpg" alt="RMS.zeta=250.psi=200.N=20" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=250.psi=210.N=20.jpg" alt="RMS.zeta=250.psi=210.N=20" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=250.psi=220.N=20.jpg" alt="RMS.zeta=250.psi=220.N=20" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=250.psi=230.N=20.jpg" alt="RMS.zeta=250.psi=230.N=20" style="zoom:33%;" />

#### 取$\zeta=0$，调节中心势能
会出现类似于受迫振动的形式
<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=0.psi=100.N=20.jpg" alt="RMS.zeta=0.psi=100.N=20" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=0.psi=200.N=20.jpg" alt="RMS.zeta=0.psi=200.N=20" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v6\image\RMS.zeta=0.psi=300.N=20.jpg" alt="RMS.zeta=0.psi=300.N=20" style="zoom:33%;" />

### 利用单个粒子进行测试

我们每次进行5副图象的作图，如下

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single.zeta=200.psi=10.jpg" alt="single.zeta=200.psi=10" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single_9s~10s.zeta=200.psi=10.jpg" alt="single_9s~10s.zeta=200.psi=10" style="zoom:45%;" />

下面我们主要尝试边界附近情况

#### $\zeta=340-360$
<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single.zeta=340.psi=0.jpg" alt="single.zeta=340.psi=0" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single.zeta=345.psi=0.jpg" alt="single.zeta=345.psi=0" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single.zeta=350.psi=0.jpg" alt="single.zeta=350.psi=0" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single.zeta=360.psi=0.jpg" alt="single.zeta=360.psi=0" style="zoom:33%;" />

#### $\zeta=300,\psi=115-140$​
<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single.zeta=300.psi=115.jpg" alt="single.zeta=300.psi=115" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single.zeta=300.psi=120.jpg" alt="single.zeta=300.psi=120" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single.zeta=300.psi=125.jpg" alt="single.zeta=300.psi=125" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single.zeta=300.psi=140.jpg" alt="single.zeta=300.psi=140" style="zoom:33%;" />

以上两种情况显示，在单粒子情况下，确实也会出现爆炸的情况，我们放大最后100个数据来看
<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single_9s~10s.zeta=300.psi=115.jpg" alt="single_9s~10s.zeta=300.psi=115" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single_9s~10s.zeta=300.psi=120.jpg" alt="single_9s~10s.zeta=300.psi=120" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single_9s~10s.zeta=300.psi=125.jpg" alt="single_9s~10s.zeta=300.psi=125" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single_9s~10s.zeta=300.psi=140.jpg" alt="single_9s~10s.zeta=300.psi=140" style="zoom:33%;" />

这种情况下看来，很可能是历史项的理论模型出现了一些问题，因为我们如果观察1s~2s部分

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single_1s~2s.zeta=300.psi=115.jpg" alt="single_1s~2s.zeta=300.psi=115" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single_1s~2s.zeta=300.psi=120.jpg" alt="single_1s~2s.zeta=300.psi=120" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single_1s~2s.zeta=300.psi=125.jpg" alt="single_1s~2s.zeta=300.psi=125" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v7\image\single_1s~2s.zeta=300.psi=140.jpg" alt="single_1s~2s.zeta=300.psi=140" style="zoom:33%;" />

## 参数分析

重新使用程序计算参数
<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4_1\processed_image\RMS.H=0.6.zeta=12.5.delta=0.01.N=3000.jpg" alt="RMS.H=0.6.zeta=12.5.delta=0.01.N=3000" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4_1\processed_image\RMS.H=0.6.zeta=100.delta=0.01.N=3000.jpg" alt="RMS.H=0.6.zeta=100.delta=0.01.N=3000" style="zoom:33%;" />
<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4_1\processed_image\RMS.H=0.7.zeta=12.5.delta=0.01.N=3000.jpg" alt="RMS.H=0.7.zeta=12.5.delta=0.01.N=3000" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4_1\processed_image\RMS.H=0.7.zeta=100.delta=0.01.N=3000.jpg" alt="RMS.H=0.7.zeta=100.delta=0.01.N=3000" style="zoom:33%;" />

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4_1\processed_image\RMS.H=0.8.zeta=12.5.delta=0.01.N=3000.jpg" alt="RMS.H=0.8.zeta=12.5.delta=0.01.N=3000" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v4_1\processed_image\RMS.H=0.8.zeta=100.delta=0.01.N=3000.jpg" alt="RMS.H=0.8.zeta=12.5.delta=0.01.N=3000" style="zoom:33%;" />

## 光滑曲线 GLEcustom_v8_smoothing

以下是从4-10次多项式进行拟合的图象

但是现在的问题就是不确定使用几次的多项式，有什么判断标准

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v8\processed_image\smooth_RMS.n=4.H=0.6.zeta=100.psi=20.delta=0.01.N=3000.jpg" alt="smooth_RMS.n=4.H=0.6.zeta=100.psi=20.delta=0.01.N=3000" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v8\processed_image\smooth_RMS.n=5.H=0.6.zeta=100.psi=20.delta=0.01.N=3000.jpg" alt="smooth_RMS.n=5.H=0.6.zeta=100.psi=20.delta=0.01.N=3000" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v8\processed_image\smooth_RMS.n=6.H=0.6.zeta=100.psi=20.delta=0.01.N=3000.jpg" alt="smooth_RMS.n=6.H=0.6.zeta=100.psi=20.delta=0.01.N=3000" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v8\processed_image\smooth_RMS.n=7.H=0.6.zeta=100.psi=20.delta=0.01.N=3000.jpg" alt="smooth_RMS.n=7.H=0.6.zeta=100.psi=20.delta=0.01.N=3000" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v8\processed_image\smooth_RMS.n=8.H=0.6.zeta=100.psi=20.delta=0.01.N=3000.jpg" alt="smooth_RMS.n=8.H=0.6.zeta=100.psi=20.delta=0.01.N=3000" style="zoom:33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v8\processed_image\smooth_RMS.n=9.H=0.6.zeta=100.psi=20.delta=0.01.N=3000.jpg" alt="smooth_RMS.n=9.H=0.6.zeta=100.psi=20.delta=0.01.N=3000" style="zoom: 33%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v8\processed_image\smooth_RMS.n=10.H=0.6.zeta=100.psi=20.delta=0.01.N=3000.jpg" alt="smooth_RMS.n=10.H=0.6.zeta=100.psi=20.delta=0.01.N=3000" style="zoom:33%;" />

（结论：使用最后三个曲线皆可，原则即为振动部分基本在0附近）

可以考虑 LOWESS算法，可以将曲线分为trend+oscillation+noise

## 初次相遇的研究

### GLEcustom_v10_first_meeting_with_function：一维情况

先确定$\Delta t=0.01$，观察$\zeta$，$\psi$，$H$的影响

#### $\zeta$增大相遇时间减少

下图中，每一个柱子表示这1秒中发现first meeting的模拟次数

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=10.delta=0.01.H=0.9.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=10.delta=0.01.H=0.9.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=25.psi=10.delta=0.01.H=0.9.N=50000.jpg" alt="meeting_time_distribution.zeta=25.psi=10.delta=0.01.H=0.9.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=50.psi=10.delta=0.01.H=0.9.N=50000.jpg" alt="meeting_time_distribution.zeta=50.psi=10.delta=0.01.H=0.9.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=100.psi=10.delta=0.01.H=0.9.N=50000.jpg" alt="meeting_time_distribution.zeta=100.psi=10.delta=0.01.H=0.9.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=200.psi=10.delta=0.01.H=0.9.N=50000.jpg" alt="meeting_time_distribution.zeta=200.psi=10.delta=0.01.H=0.9.N=50000" style="zoom: 45%;" />

#### $\psi$增加使得相遇时间减少

$\psi=0.625,1.25,2.5,5,10$

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=0.625.delta=0.01.H=0.6.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=0.625.delta=0.01.H=0.6.N=50000" style="zoom: 45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=1.25.delta=0.01.H=0.6.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=1.25.delta=0.01.H=0.6.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=2.5.delta=0.01.H=0.6.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=2.5.delta=0.01.H=0.6.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.6.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.6.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=10.delta=0.01.H=0.6.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=10.delta=0.01.H=0.6.N=50000" style="zoom:45%;" />

#### $H$增加影响不显著（$H=0.7,0.8$时时间略长）

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.6.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.6.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.7.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.7.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.8.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.8.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.9.N=50000.jpg" alt="meeting_time_distribution.zeta=12.5.psi=5.delta=0.01.H=0.9.N=50000" style="zoom:45%;" />

较快速相遇的数量基本不变

#### $\Delta t$的影响

关于fbm过程应当满足以下性质
$$
B_{H}(c t) \stackrel{d}{=} c^{H} B_{H}(t)
$$
其中$\stackrel{d}{=}$表示分布上相同。但是实际上，由于未能完全确定这一性质对wfbm生成的fbm也满足，我没有使用这个公式，而是在算法中使用0.01来生成随机力，但是使用$\Delta t=0.1$来进行模拟.

并减小$N$大小，从而比较分布。

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\image\meeting_time_distribution.zeta=50.psi=10.delta=0.01.H=0.7.N=50000.jpg" alt="meeting_time_distribution.zeta=50.psi=10.delta=0.01.H=0.7.N=50000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\v10\delta=0.1.png" alt="delta=0.1" style="zoom:45%;" />

#### 与实验结果不甚符合的原因分析

- 参数未进行调整（但是所有参数范围内的趋势基本都是如此）
- 仅模拟了一维情况
- 相遇与回到原点不完全相等
- $\Delta t$和interval的算法机理仍然有问题

### GLEcustom_v12_first_meeting_3d_with_fbm_change & GLEcustom_v13_fm_3d_fc_dh 三维情况

本部分除了增加三维部分之外，增设了相遇距离（暂定0.1）调整了随机项的大小，历史保留项机制（取匀速运动计算历史项，取70%留存即可（由于实际情况历史有正有负，所以认为此历史项近似还是较为严格的））但是实际情况仍然不甚理想，最多加快进度2-3倍，可能需要采取更好的近似方法

由于数据仍然在进行计算，结果就暂时就先不展示了。

实际上，如果此部分仅仅用来实现对实验的预测，计算量较大是可以接受的。

## 实验参数拟合

### 编程思路

#### 初始想法

使用实验数据拟合，作出光滑曲线X。将各种参数计算模拟的点进行拟合，形成一组光滑曲线族Y，由$\zeta,\psi,H$（目前不考虑$\Delta t$，可以在程序运行成功后）。比较光滑曲线X与光滑曲线族Y中的各个曲线，找到最相似的

拟合方法：使用lowess算法（matlab版本中仅三维情况，二维情况还需另外寻找）

#### 改进想法

在观察了实验数据后，我发现实际情况不需要如此。因为最多的数据仅有100个点左右，只需要将每个数据代入拟合曲线族中，计算其残差即可。进一步，或许根本不需要代入拟合曲线，只需要简单将拟合数据点连线即可。

#### 进展

之后我使用了类似二分法的方法，将三个参数看作三维的坐标轴，然后进行分割，取方差最小的三维区域，继续进行分割。

这一想法看起来很自然，实际上建立在几个假设之上：

- 在三维参数空间中方差的分布在大部分位置是单调（连续）的。虽然曲线的变化趋势在之前的测试中基本上可以确定较为单调（除了H），但是残差是否也满足？
- 其次，是否真的存在一组参数确定的拟合的数据组与实验情况符合性较好？实际上，我们可能需要截断一部分的实验数据（因为之后的部分波动较大，甚至大部分有回落趋势）
- 其次，三个维度的实验数据，$\zeta,H$的大小应当不变，改变的仅仅是势能大小$\psi$，这一点或许我们要考虑三组实验数据共同考虑？

### 二分法

#### 问题1

在二分法运行后，最后得到的结果导向“爆炸”情况。在进行一系列的分析后，发现所有的结果的数量级都出现问题
$$
i=t/\Delta t\\
a(t+\Delta  t)=-\frac{\zeta}{m}\sum_{k=0}^{i-1}2H\cdot(2H-1)\cdot(i\cdot\Delta t-k\cdot\Delta t)^{2H-2}\cdot v(k\cdot\Delta t)\\-\psi\cdot x(t)+\frac{\sqrt{2 \xi k_{B} T}}{m} \frac{B_H(t+\Delta t)-B_{H}(t)}{\Delta t}\\
v(t+\Delta t)=v(t)+a(t)\Delta t\\
x(t+\Delta t)=x(t)+v(t)\Delta  t
$$
在公式中m对方程的影响不可以完全包含在$\zeta$和$\psi$中，因此也必须作为参数。

进行一系列快速测试后，大致可以确定范围（通过RMS的量级）即m大约在$10^{-6}$量级。此时在$\zeta$和$\psi$在$10^{-5}$内时，不会爆炸，大概估计在$10^{-6}$量级上。

#### 问题2

在进行一些小模拟，使用$ax^3+bx^2+cx+d$的函数，使用二分法后发现结果完全错误。

此方法间隔太稀疏，容易漏去

### 网格搜索法

初步进行尝试，可以首先使用10个取样点，并将爆炸的情况residual设置为$\infty$

如果仅仅进行初次筛选，结果尚可，多次搜索结果有待计算

#### 第一轮搜索

初始参数为，N=200，取样频率=5

<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20211102235702309.png" alt="image-20211102235702309" style="zoom:33%;" />

最终结果为最小残差位置为$(i_m,i_\psi,i_\zeta)=(2,3,2)$，但是在$(2,5,2)$处残差也较小



#### 第二轮搜索

初始参数取为

![image-20211105173016648](C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20211105173016648.png)

搜索结果发现，$(3,4,3)$z位置取到最小值，但是$(3,?,3)$均较小。因此第三轮搜索$\psi$范围不变

#### 第三轮搜索

初始参数取为

![image-20211106230024097](C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20211106230024097.png)

在（4，？，2），（4，？，4）处取到极小值

大致范围为

<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20211117003347880.png" alt="image-20211117003347880" style="zoom:50%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20211117003403344.png" alt="image-20211117003403344" style="zoom:50%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20211117003320939.png" alt="image-20211117003320939" style="zoom:50%;" />

#### 第四轮搜索



### 随机搜索法

### 神经网络法

经过一系列学习后，以及与室友gxx讨论，发现此方法（至少使用反向传递法）不适合本模型（由于本模型为非马尔可夫过程）

### 梯度下降法
<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\P.S.G.D\image\residual history image N=2000 step=0.1 2021-11-19 16.png" alt="residual history image N=2000 step=0.1 2021-11-19 16" style="zoom:30%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\P.S.G.D\image\residual history image N=2000 step=0.1 2021-11-21 12.png" alt="residual history image N=2000 step=0.1 2021-11-21 12" style="zoom:30%;" />


## 第二轮测试（20211120组会后）

### 测试爱因斯坦扩散定律


<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20211204184154268.png" alt="image-20211204184154268"  />
$$
1m \frac{d v(t)}{d t}=-\zeta v(t)+\sqrt{2 \zeta k_{B} T} d B_{H}(t) / d t\\2a(t+\Delta  t)=-\frac{\zeta}{m}v(t)+\frac{\sqrt{2 \zeta k_{B} T}}{m} \frac{B_H(t+\Delta t)-B_{H}(t)}{\Delta t}\\3v(t+\Delta t)=v(t)+a(t)\Delta t\\4x(t+\Delta t)=x(t)+v(t)\Delta  t
$$
最终应当满足爱因斯坦扩散定律：$<x^2>=2Dt$，其中$D=\frac{R T}{6 N_{A} \pi r \sigma}$

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\测试m，psi参数对曲线影响不正常的问题\爱因斯坦扩散定律的验证\MSD.m=5e-09.psi=1.zeta=1e-08 2e-08 3e-08 4e-08 5e-08.H=0.75.delta=0.1.N=5000.jpg" alt="MSD.m=5e-09.psi=1.zeta=1e-08 2e-08 3e-08 4e-08 5e-08.H=0.75.delta=0.1.N=5000" style="zoom: 30%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\测试m，psi参数对曲线影响不正常的问题\爱因斯坦扩散定律的验证\MSD.m=3e-09 4e-09 5e-09 6e-09 7e-09.psi=1.zeta=3e-08.H=0.75.delta=0.1.N=5000.jpg" alt="MSD.m=3e-09 4e-09 5e-09 6e-09 7e-09.psi=1.zeta=3e-08.H=0.75.delta=0.1.N=5000" style="zoom:30%;" />

### 加入中心势

$$
m \frac{d v(t)}{d t}=-\zeta v(t)-m\psi\cdot x(t) +\sqrt{2 \xi k_{B} T} d B_{H}(t) / d t\\2a(t+\Delta  t)=-\frac{\zeta}{m}v(t)-\psi\cdot x(t)+\frac{\sqrt{2 \xi k_{B} T}}{m} \frac{B_H(t+\Delta t)-B_{H}(t)}{\Delta t}\\3v(t+\Delta t)=v(t)+a(t)\Delta t\\4x(t+\Delta t)=x(t)+v(t)\Delta  t
$$

基本符合理论

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\测试m，psi参数对曲线影响不正常的问题\含中心势爱因斯坦扩散\MSD.m=5e-09.psi=0.1   0.3   0.5   0.7   0.9.zeta=3e-08.H=0.75.delta=0.1.N=5000.jpg" alt="MSD.m=5e-09.psi=0.1   0.3   0.5   0.7   0.9.zeta=3e-08.H=0.75.delta=0.1.N=5000" style="zoom:30%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\测试m，psi参数对曲线影响不正常的问题\含中心势爱因斯坦扩散\MSD.m=5e-09.psi=1.zeta=1e-08 2e-08 3e-08 4e-08 5e-08.H=0.75.delta=0.1.N=5000.jpg" alt="MSD.m=5e-09.psi=1.zeta=1e-08 2e-08 3e-08 4e-08 5e-08.H=0.75.delta=0.1.N=5000" style="zoom:30%;" />

### 解释反常现象

反常的m情况，实际上，这可能是因为参数趋近于爆炸情况

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2021.11 图像\大尺度\RMS.m=3e-09 4e-09 5e-09 6e-09 7e-09.psi=2.5e-07.zeta=3e-08.H=0.75.delta=0.1.N=2000.jpg" alt="RMS.m=3e-09 4e-09 5e-09 6e-09 7e-09.psi=2.5e-07.zeta=3e-08.H=0.75.delta=0.1.N=2000" style="zoom:45%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\测试m，psi参数对曲线影响不正常的问题\未修改时\MSD.m=4e-09 5e-09 6e-09 7e-09 8e-09 9e-09.psi=2.5e-07.zeta=3e-08.H=0.75.delta=0.1.N=1000.jpg" alt="MSD.m=4e-09 5e-09 6e-09 7e-09 8e-09 9e-09.psi=2.5e-07.zeta=3e-08.H=0.75.delta=0.1.N=1000" style="zoom:30%;" />

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\测试m，psi参数对曲线影响不正常的问题\未修改时\MSD.m=2e-09 3e-09 4e-09.psi=2.5e-07.zeta=3e-08.H=0.75.delta=0.1.N=50.jpg" alt="MSD.m=2e-09 3e-09 4e-09.psi=2.5e-07.zeta=3e-08.H=0.75.delta=0.1.N=50" style="zoom:30%;" />

反常的$\psi$情况，在低$\psi$下，发现MSD与$\psi$无关

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2021.11 图像\大尺度\RMS.m=5e-09.psi=2e-08 5e-08 1e-07 2e-07 4e-07.zeta=3e-08.H=0.75.delta=0.1.N=2000.jpg" alt="RMS.m=5e-09.psi=2e-08 5e-08 1e-07 2e-07 4e-07.zeta=3e-08.H=0.75.delta=0.1.N=2000" style="zoom:30%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\数据模拟\测试m，psi参数对曲线影响不正常的问题\image\MSD.m=5e-09.psi=0.1   0.5     1.zeta=3e-08.H=0.75.delta=0.1.N=5000.jpg" alt="MSD.m=5e-09.psi=0.1   0.5     1.zeta=3e-08.H=0.75.delta=0.1.N=5000" style="zoom:30%;" />

## 改进梯度下降法

### 初步参数

手动调整参数（一位有效数字）使得小次数模拟曲线与实验曲线尽量贴近

<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220217172203177.png" alt="image-20220217172203177" style="zoom:33%;" />

| 项目    | 曲线 | 参数组$[m,\psi,\zeta,H]$                    |
| ------- | ---- | ------------------------------------------- |
| p47_5s  | xy   | [6e-09,0.5,2e-08,0.75]                      |
|         | z    | [3e-09,0.2,2e-08,0.74]                      |
| p77_5s  | xy   | [5e-09,0.1,2e-08,0.75]                      |
|         | z    | [3e-9,0.1,1e-8,0.77]                        |
| p179_5s | x    | [4e-09,0.06,1.5e-08,0.75]                   |
|         | y    | [4e-09,0.12,2e-08,0.75]                     |
|         | z    | [2e-9,0.1,8e-9,0.76]                        |
| n78_5s  | x    | [3e-09,0.05,2.5e-08,0.75]                   |
|         | y    | [3e-9,0.15,2e-8,0.75]                       |
|         | z    | [3e-09,0.1,2e-08,0.70]                      |
| n142_5s | x    | [3e-9,0.15,2.2e-8,0.75]后半段不契合         |
|         | y    | [3e-9,0.2,2e-8,0.77]                        |
|         | z    | [2e-9,0.15,1e-8,0.74]后半段不契合，残差偏大 |



### 残差误差与N关系

#### 初步模拟

对于N=100，N_simulation=10，残差标准差为<u>**平均值**</u>的标准差.

对p_47_5s_x的实验数据，对参数组[6e-09,0.5,1.72e-08,0.75]进行误差模拟

| N    | N    | N_simulation | 残差标准差/$m^4$ |
| ---- | ---- | ------------ | ---------------- |
| 1    | 100  | 10           | 5.1306e-27       |
| 2    | 200  | 10           | 6.1628e-27       |
| 3    | 500  | 10           | 4.3842e-27       |
| 4    | 100  | 100          | 3.3741e-27       |
| 5    | 200  | 100          | 2.2937e-27       |
| 6    | 500  | 100          | 1.4215e-27       |

因此我们大致认为，$\sigma_r\cdot\sqrt N\approx C\approx(1\times10^{-25})m^4\times\sqrt{10}$.

#### 理论推导

这里的详细推导如下，但是建立在一定的近似上：认为$\overline{x},\sqrt{\overline{x^2}},\sqrt[3]{\overline{x^3}},\sqrt[4]{\overline{x^4}}$基本为同一量级，且$N>>1$

![image-20220220174354675](C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220220174354675.png)

#### 更多模拟

将收集的其他数据列入一张表格

| data      | [m,psi,zeta,H]                        | N    | N_simulation | error    | error*N^0.5 |
| --------- | ------------------------------------- | ---- | ------------ | -------- | ----------- |
| p_47_5s_x | [6e-09,0.5,1.72e-08,0.75]             | 100  | 100          | 3.37E-27 | 3.37E-26    |
| p_47_5s_x | [6e-09,0.5,1.72e-08,0.75]             | 200  | 100          | 2.29E-27 | 3.24E-26    |
| p_47_5s_x | [6e-09,0.5,1.72e-08,0.75]             | 500  | 100          | 1.42E-27 | 3.18E-26    |
| p_47_5s_z | [3e-09,0.2,2e-08,0.74]                | 50   | 100          | 3.22E-26 | 2.27E-25    |
| p_47_5s_z | [3e-09,0.2,2e-08,0.74]                | 100  | 100          | 2.28E-26 | 2.28E-25    |
| p_47_5s_z | [3e-09,0.2,2e-08,0.74]                | 200  | 100          | 1.71E-26 | 2.41E-25    |
| p_47_5s_z | [3.0170e-09,0.2032,1.9977e-08,0.7321] | 50   | 100          | 1.56E-26 | 1.10E-25    |
| p_47_5s_z | [3.0170e-09,0.2032,1.9977e-08,0.7321] | 100  | 100          | 1.21E-26 | 1.21E-25    |
| p_47_5s_z | [3.0170e-09,0.2032,1.9977e-08,0.7321] | 200  | 100          | 7.46E-27 | 1.06E-25    |

可以发现，参数略微变化，误差变化较大

## 实验数据的处理

#### 截断

将xy的数据平均，根据<u>**肉眼判断**</u>出能够处理的长度，基本上是波动较小的阶段的<u>**最高点或拐点**</u>。

| data      | reserved_length 保留的长度 |
| --------- | -------------------------- |
| p47_5s    | 82                         |
| p77_5s    | 85                         |
| p179_5s   | 81                         |
| n78_5s    | 73                         |
| n142_5s   | 51                         |
| p47_30s   | 65                         |
| p77_30s   | 57                         |
| p179_30s  | 70                         |
| n78_30s   | 72                         |
| n_142_30s | 73                         |
| n_589_30s | 40                         |



#### svd降噪

截断后，5s族的处理后实验数据如下左图

<center><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\svd\5s族截断后实验数据.jpg" style="zoom:20%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\svd\5s族svd保留2奇异值曲线.jpg" style="zoom: 20%;" /></center>

之后进行svd处理，对5s族数据，得到的奇异值为：3.1e6	7.9e4	1.7e4	9.1e3	6.9e3

只保留前两个奇异值，得到的曲线图像如上右图

阶段后，30s族的处理后实验数据如下左图

<center><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\svd\30s族截断后实验数据.jpg" style="zoom: 20%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\svd\30s族svd保留2奇异值曲线.jpg" style="zoom: 20%;" /></center>

svd处理得到的奇异值为：4.99e6	1.72e5	1.69e4	9.76e3	8.30e3	5.00e3

只保留前两个奇异值，得到的曲线图像为上右图

#### svd正交矢量分析

将5s族和30s族中n和p分开处理，$A=U\Sigma V^T$，观察正交矩阵的前

5s_p序列，下图由左到右分别为处理后曲线，U的前三行，V的前两列

<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313133511046.png" style="zoom:5%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313133515776.png" alt="image-20220313133515776" style="zoom:5%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313133520703.png" alt="image-20220313133520703" style="zoom:5%;" />

5s_n序列，仅两曲线，下图由左到右分别为处理后曲线，U的前三行，V的前两列
<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313134105822.png" alt="image-20220313134105822" style="zoom:5%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313134117674.png" alt="image-20220313134117674" style="zoom:5%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313134125984.png" alt="image-20220313134125984" style="zoom:5%;" />

30s_p序列，下图由左到右分别为处理后曲线，U的前三行，V的前两列
<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313134257178.png" alt="image-20220313134257178" style="zoom:5%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313134307899.png" alt="image-20220313134307899" style="zoom:5%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313134317544.png" alt="image-20220313134317544" style="zoom:5%;" />

30s_n序列，下图由左到右分别为处理后曲线，U的前三行，V的前两列
<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313134408760.png" alt="image-20220313134408760" style="zoom:5%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313134417959.png" alt="image-20220313134417959" style="zoom:5%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220313134426440.png" alt="image-20220313134426440" style="zoom:5%;" />

#### Exponential 拟合

<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220320130011813.png" alt="image-20220320130011813" style="zoom:33%;" />

这里记录各个曲线的结果：

```matlab
fun=inline('a(1)*exp(a(2)*t)+a(3)*exp(a(4)*t)','a','t');
t=time_scale;

min_length=51;%5s

a(1)=1.046e+05;%p47_5s
a(2)=0.0004364;
a(3)=-7.307e+04;
a(4)=-0.03125;

a(1)=1.563e+05;%p77_5s
a(2)=0.0005822;
a(3)=-1.12e+05;
a(4)=-0.02877;

a(1)=2.196e+05;%p179_5s
a(2)=0.0009865;
a(3)=-1.76e+05;
a(4)=-0.0219;

a(1)=2.343e+05;%n78_5s
a(2)=0.0008002;
a(3)=-1.766e+05;
a(4)=-0.02509;

a(1)=1.906e+05;%n142_5s
a(2)=0.0008269;
a(3)=-1.448e+05;
a(4)=-0.02463;

min_length=40;%30s

a(1)=1.086e+05;%p47_30s
a(2)=4.919e-05;
a(3)=-5.73e+04;
a(4)=-0.01903;

a(1)=1.889e+05;%p77_30s
a(2)=7.362e-05;
a(3)=-9.881e+04;
a(4)=-0.01475;

a(1)=3.046e+05; %p179_30s
a(2)=0.0001123;
a(3)=-1.851e+05;
a(4)=-0.008373;

a(1)=3.227e+05; %n78_30s
a(2)=0.0001119;
a(3)=-1.951e+05;
a(4)=-0.00845;


a(1)=2.542e+05;%n142_30s
a(2)=9.705e-05;
a(3)=-1.391e+05;
a(4)=-0.01086;
       
       
a(1)=5.385e+05;%n589_30s
a(2)=0.0001211;
a(3)=-3.902e+05;
a(4)=-0.006544;   

```

对拟合结果进行梯度下降

## 初次相遇（First_Passage Time）情况再探究

根据8中的结果计算初次相遇情况，计算相遇步数的分布。调整$meeting\_distance$，得到一个正常的分布。

### ~~一维FPT分布示例~~

~~我们取相遇判据为$r\leq1\times10^{-12}$，此时的分布为类似$\delta$函数。一旦相遇判据过大或过小，相遇分布会大概率失效。~~在debug后，得到的三维新模拟结果中，无论$r$取值多少，相遇概率也基本为0.因此准备先探究一维情况下的FPT分布

#### ~~1e-9量级：$p(t)\propto \exp(-\alpha t)$~~

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\FPT_1d\FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=1e-09.N=100000.jpg" alt="FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=1e-09.N=100000" style="zoom:20%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\FPT_1d\FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=2e-09.N=100000.jpg" alt="FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=2e-09.N=100000" style="zoom:20%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\FPT_1d\FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=5e-09.N=100000.jpg" alt="FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=5e-09.N=100000" style="zoom:20%;" />

#### ~~1e-8量级：在指数下降基础上形成多峰~~

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\FPT_1d\FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=1e-08.N=100000.jpg" alt="FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=1e-08.N=100000" style="zoom:20%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\FPT_1d\FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=2e-08.N=100000.jpg" alt="FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=2e-08.N=100000" style="zoom:20%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\FPT_1d\FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=5e-08.N=100000.jpg" alt="FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=5e-08.N=100000" style="zoom:20%;" />

#### ~~1e-7量级：大部分生成在相遇距离以内（无物理意义）~~

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.03图像\FPT_1d\FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=1e-07.N=100000.jpg" alt="FPT_distribution.m=6.0727e-09.psi=0.5127.zeta=2.0212e-08.H=0.69714.d=1e-07.N=100000" style="zoom:25%;" />

### ~~关于一维到三维FPT分布的推导~~

~~如果认为$p^{(1)}(t)\propto \exp(-\alpha t)$，则对于三维情况，$t$时刻时候到达原点附近位置（$|x|,|y|,|z|<d$）的概率约有$p^{(3)}(t)\propto \exp(-3\alpha t)$，但是由于系数本就$<<1$，因此三维情况下FPT在$t<500s$下相遇的概率密度大约在$10^{-6}-10^{-12}/s$量级左右，难以进行模拟。~~

### 模拟的验证方法

实际上10.1中的模拟结果已被证实底层代码错误。为了保证模拟结果尽量可信，在修改了模拟底层代码后，首先使用一维布朗运动（公式来自于[wikipedia](https://en.wikipedia.org/wiki/Langevin_equation#Brownian_motion_as_a_prototype)）进行测试。
$$
a(k,i+1)=-\frac{\zeta}{m} \cdot v(k,i)+\sqrt{2\zeta\cdot k_BT}\frac{BH(k,i+1)-BH(k,i)}{m\cdot\Delta t}\\
H=0.5
$$
由[wikipedia](https://en.wikipedia.org/wiki/First-hitting-time_model#First_passage_time_of_a_1D_Brownian_particle)上的结论，有
$$
f(t) \equiv \frac{\left|x_{c}-x_{0}\right|}{\sqrt{4 \pi D t^{3}}} \exp \left(-\frac{\left(x_{c}-x_{0}\right)^{2}}{4 D t}\right)
$$
For $\displaystyle t \gg \frac{\left(x_{c}-x_{0}\right)^{2}}{4 D}$, it follows from above that
$$
f(t)=\frac{\Delta x}{\sqrt{4 \pi D t^{3}}} \sim t^{-3 / 2}
$$
先模拟扩散系数$D$，得到在参数为`[6.072747499083493E9,0.5127045898796013,2.021229880364061E-8,0.5]`时的扩散系数,$x^2=2Dt=6.2E-12\times t$，$D=3.1E-12$. （拟合情况如下图）

![image-20220417153416719](C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220417153416719.png)

而使用幂函数拟合得到的结果，模拟的1d布朗运动FPT有：（初始位置固定为$x_0=1E-7m$）在理论上，$\displaystyle t\gg \frac{\left(x_{c}-x_{0}\right)^{2}}{4 D}=8.06\times 10^{-4}s$

取其中5s-100s进行分析（之后波动较大），进行拟合，得到结果系数$k=-1.54$与理论值$k_t=-1.5$相差不大

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.04图像\FPT test\test2\with fitness k=1.54.jpg" alt="with fitness k=1.54" style="zoom:50%;" />

### 新的模拟

同时，我们也进行了后续的模拟：变化Tmax和Interaction Zone来观察FPT分布的变化。使用p_47_5s的参数进行模拟，模拟速度（使用工作站）如下图所示

| 序号 | Tmax | 一分钟模拟数量 | 单词模拟用时$t_0/s$ |
| ---- | ---- | -------------- | ------------------- |
| 1    | 500  | 25             | 2.4                 |
| 2    | 1000 | 9              | 6.6                 |
| 3    | 1500 | 4              | 15                  |
| 4    | 2000 | 3              | 20                  |

直接对$Tmax=2000$的情况模拟10000次，大致用时50h。

结果有些奇怪：

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.04图像\FPT 3d\FPT_distribution.m=6.0244e-09.psi=0.2017.zeta=2.006e-08.H=0.7569.d=5e-08.N=100000.jpg" alt="FPT_distribution.m=6.0244e-09.psi=0.2017.zeta=2.006e-08.H=0.7569.d=5e-08.N=100000" style="zoom:25%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.04图像\FPT 3d\FPT_distribution.m=6.0244e-09.psi=0.2017.zeta=2.006e-08.H=0.7569.d=5e-08.N=10000.jpg" alt="FPT_distribution.m=6.0244e-09.psi=0.2017.zeta=2.006e-08.H=0.7569.d=5e-08.N=10000" style="zoom:25%;" />

### FDE of GLENII（无惯性项）的模拟

这里我们考虑无惯性项的情况，算法变为：
$$
m \psi x(t) d t=-\zeta\left(\int_{-\infty}^{t} K_{H}(t-u) v(u) d u\right) d t+\sqrt{2 \zeta k_{B} T} d B_{H}(t)\\
i=t/\Delta t\\
x(t+\Delta  t)=\frac{1}{m\cdot\psi}\left(-\zeta\sum_{k=0}^{i-1}2H\cdot(2H-1)\cdot(i\cdot\Delta t-k\cdot\Delta t)^{2H-2}\cdot v(k\cdot\Delta t)\right.\\
\left.+{\sqrt{2 \zeta k_{B} T}} \frac{B_H(t+\Delta t)-B_{H}(t)}{\Delta t}\right)\\
v(t+\Delta t)=\frac{x(t+\Delta t)+x(t)}{\Delta t}
$$
以p_47_5s的参数进行模拟

## 其他模型寻找

### CTRW Model & FDE

这两个模型的建立，是来源于解决半导体内部的电子反常扩散问题：核心假设认为粒子在一个时刻瞬 时地跳跃到另外的一个位置, 这个 过程是随机地, 并且在两次跳跃之 间的时间间隔服从一个概率分布函 数。因此可能<u>**物理图像与DNA相差甚远**</u>。FDE为描述CTRW的方程

#### CTRW模型的基本设定

jump length pdf$\Longrightarrow$jump length variance
$$
\lambda(x)=\int_{0}^{\infty} \mathrm{d} t \psi(x, t)\Longrightarrow\Sigma^{2}=\int_{-\infty}^{\infty} \mathrm{d} x \lambda(x) x^{2}
$$
waiting time pdf$\Longrightarrow$characteristic waiting time
$$
w(t)=\int_{-\infty}^{\infty} \mathrm{d} x \psi(x, t)\Longrightarrow T=\int_{0}^{\infty} \mathrm{d} t w(t) t
$$
Considering, having arrived at position $x$ at time $t$, define its pdf as $\eta(x, t)$, it follows equation:
$$
\eta(x, t)=\int_{-\infty}^{\infty} \mathrm{d} x^{\prime} \int_{0}^{\infty} \mathrm{d} t^{\prime} \eta\left(x^{\prime}, t^{\prime}\right) \psi\left(x-x^{\prime}, t-t^{\prime}\right)+\delta(x) \delta(t)
$$
Consequently, the pdf $W(x, t)$ of being in $x$ at time $t$ is given by
$$
W(x, t)=\int_{0}^{t} \mathrm{~d} t' \eta\left(x, t^{\prime}\right) \Psi\left(t-t^{\prime}\right)\\
\Psi(t)=1-\int_{0}^{t} \mathrm{~d} t^{\prime} w\left(t^{\prime}\right)
$$

In Fourier-Laplace space, the above formula can be transformed into
$$
W(k, u)=\frac{1-w(u)}{u} \frac{W_{0}(k)}{1-\psi(k, u)}
$$

#### FDE的由来

approximately, $w(u) \sim 1-(u \tau)^{\alpha}$, so that, employing the integration rule for fractional integrals
$$
W(k, u)=\frac{\left[W_{0}(k) / u\right]}{1+K_{\alpha} u^{-\alpha} k^{2}}\\
\Longrightarrow\frac{\partial W}{\partial t}={ }_{0} D_{t}^{1-\alpha} K_{\alpha} \frac{\partial^{2}}{\partial x^{2}} W(x, t)
$$
The Riemann-Liouville operator ${ }_{0} D_{t}^{1-\alpha}=(\partial / \partial t)_{0} D_{t}^{-\alpha}$, for $0<\alpha<1$, is defined through the relation
$$
{ }_{0} D_{t}^{1-\alpha} W(x, t)=\frac{1}{\Gamma(\alpha)} \frac{\partial}{\partial t} \int_{0}^{t} \mathrm{~d} t^{\prime} \frac{W\left(x, t^{\prime}\right)}{\left(t-t^{\prime}\right)^{1-\alpha}} .
$$
And via $\left\langle x^{2}\right\rangle=\lim _{k \rightarrow 0}\left\{-\left(\mathrm{d}^{2} / \mathrm{d} k^{2}\right) W(k, u)\right\}$,
$$
\left\langle x^{2}(t)\right\rangle=\frac{2 K_{\alpha}}{\Gamma(1+\alpha)} t^{\alpha}
$$



#### MSD

在吸收/反射反射型边界下，实际上就是给出边值条件，概率密度分布变为
$$
Q(x, t)=\sum_{m=-\infty}^{\infty}[W(x+4 m a, t) \mp W(4 m a-x+2 a, t)]
$$
其中吸收取$-$，反射取$+$，即可以解pdf和MSD
$$
Q(x, t)=\frac{1}{2 a}+\frac{1}{a} \sum_{m=1}^{\infty} \mathrm{e}^{\pi \mathrm{i} m x / a} E_{\gamma}\left(-K_{\gamma} \frac{\pi^{2} m^{2}}{a^{2}} t^{\gamma}\right)\\
\left\langle x^{2}\right\rangle_{a}=\frac{a^{2}}{3}+\frac{4 a^{2}}{\pi^{2}} \sum_{m=1}^{\infty} \frac{(-1)^{m}}{m^{2}} E_{\gamma}\left(-K_{\gamma} \frac{m^{2} \pi^{2}}{a^{2}} t^{\gamma}\right) .
$$
显然，$t\rightarrow \infty,MSD\rightarrow Ca^2/3$，其中$E_\gamma$为Mittag-Leffler函数$E_{\alpha,\beta}$，实际上有：
$$
E_\gamma(z)=E_{\gamma,1}(z)
$$
可以调用官网下载的mlf.m函数进行求解，mlf函数四个参数分别为$\alpha,\beta,z,p$，$p$代表精确到的量级为$10^{-p}$，目前取$p=6$

但注意到这与实验的情况不符合。

![image-20220327150000277](C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220327150000277.png)

#### FPT分布

对CRTW model：
$$
\begin{aligned} 
\pi(\theta) \simeq & \frac{u\left(\mathbf{r}_{T}, \mathbf{r}_{S}\right)}{v\left(\mathbf{r}_{T}\right)} \frac{\sin (\alpha \pi)}{\pi}  \times \int_{0}^{\infty} \frac{x^{\alpha}}{1+2 \cos (\alpha \pi) x^{\alpha}+x^{2 \alpha}} e^{-x \theta} d x \\
\theta \equiv &\frac{t}{\left\{\left[N \boldsymbol{v}\left(\mathbf{r}_{T}\right)\right]^{1 / \alpha} \tau\right\}}\\

\end{aligned}
$$
对FDE model，在上式的基础上可以做进一步近似：
$$
\pi(t)=\frac{1}{\pi} \sum_{k=1}^{\infty} \frac{(-1)^{k+1}}{k !} \sin (\pi \alpha k) \Gamma(\alpha k+1)\left(\frac{D}{K_{\alpha}}\right)^{k} \frac{\left\langle T_{0}^{k}\right\rangle}{t^{\alpha k+1}}
$$
在long-time decay下，$k=1$的项占主导：
$$
\pi(t) \sim \frac{\alpha D\left\langle T_{0}\right\rangle}{\Gamma(1-\alpha) K_{\alpha} t^{1+\alpha}}
$$

## FDE-WRB模型的MSD拟合

Fractioanl diffusion equation with relecting boundaries

### 算法

使用梯度下降+格点搜索结合：FDE_para_select_fv4_GD_multi.mlx

初始位置进行格点搜索，每个格点进行10次最速下降，最终得到的residual最小的位置

### p47_5s筛选细节

这里先详细记录p47_5s的情况，其余仅记录结果

初次搜索范围：

```
range_a=5e-7:1e-8:7e-7;
range_Gamma=0.45:0.005:0.55;
range_K_gamma=1e-14:1e-15:3e-14;
```

得到的最佳参数为：由`input=[6.6e-07,0.485,1e-14];`得到的
$[6.59526720061982e-07,0.484015713917871,	9.88791977911751e-15]$

对其继续进行最速下降法优化有：

```
[6.58760713500703e-7,0.513507050145826,8.50064230301368e-15];
```

其PDE-MSD结果如下图所示：

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.04图像\FDE\FDE-MSD.a=6.5876e-07.Gamma=0.51351.K_gamma=8.5006e-15.jpg" alt="FDE-MSD.a=6.5876e-07.Gamma=0.51351.K_gamma=8.5006e-15" style="zoom:33%;" />

第二轮搜索范围：
`range_a=6e-7:1e-8:7e-7;
range_Gamma=0.48:0.005:0.52;
range_K_gamma=1e-15:1e-15:1e-14;`

得到的最佳参数为：
`[6.57633000005001e-07,0.527547403866792,8.04897057587242e-15]`

继续对其进行最速下降(first step=0.01)，最终得到参数：
`[6.50191418993925e-07,0.540777913641586,7.90772145059038e-15]`

其PDE-MSD结果如下图所示：

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.04图像\FDE\FDE-MSD.a=6.5019e-07.Gamma=0.54078.K_gamma=7.9077e-15.jpg" alt="FDE-MSD.a=6.5019e-07.Gamma=0.54078.K_gamma=7.9077e-15" style="zoom:33%;" />

### 各个曲线的参数结果

最终的参数曲线和输入曲线间残差不超过$5\times10^{-28}m^4$，对于MSD整体较大的，可以适当放宽要求

| 数据     | 基因距离/kb | $a$         | $\gamma$ | $K_\gamma$  | 残差       |
| -------- | ----------- | ----------- | -------- | ----------- | ---------- |
| p47_5s   | 47          | 6.4879e-07  | 0.54315  | 7.8411e-15  | 1.1766e-28 |
| p77_5s   | 77          | 8.1623e-07  | 0.55234  | 1.02047e-14 | 1.7987e-28 |
| p179_5s  | 179         | 1.09899e-06 | 0.56136  | 9.9842e-15  | 1.9985e-28 |
| n78_5s   | 78          | 1.10261e-06 | 0.50944  | 1.47452e-14 | 4.3105e-28 |
| n142_5s  | 142         | 9.7378e-07  | 0.54515  | 1.04687e-14 | 1.9611e-28 |
| p47_30s  | 47          | 6.0086e-07  | 0.55727  | 9.3167e-15  | 7.3119e-29 |
| p77_30s  | 77          | 7.9325e-07  | 0.68138  | 7.1091e-15  | 9.4792e-29 |
| p179_30s | 179         | 1.11078e-06 | 0.49278  | 1.57003e-14 | 4.3149e-28 |
| n78_30s  | 78          | 1.13521e-06 | 0.50504  | 1.59103e-14 | 4.1874e-28 |
| n142_30s | 142         | 9.7171e-07  | 0.51216  | 1.60487e-14 | 2.3856e-28 |
| n589_30s | 589         | 1.4573e-06  | 0.62456  | 1.09373e-14 | 1.0665e-27 |

将上表中结果作图：

<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220417152026162.png" alt="image-20220417152026162" style="zoom:25%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220417152044958.png" alt="image-20220417152044958" style="zoom:25%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220417152100321.png" alt="image-20220417152100321" style="zoom:25%;" />

## GLE-NII模型的MSD拟合

Generlized Langevin Equation with no inertia item

### 梯度下降算法

使用的GLE的形式如下：
$$
m \psi x(t) d t=-\zeta\left(\int_{-\infty}^{t} K_{H}(t-u) v(u) d u\right) d t+\sqrt{2 \zeta k_{B} T} d B_{H}(t) \\
$$
其给出的运动的统计分布有：
$$
\sigma_{x}(t)=\langle x(0) x(t)\rangle=\frac{k_{B} T}{m \psi} E_{2-2 H}\left(-(t / \tau)^{2-2 H}\right) \\
\operatorname{Var}[x(0)]=\langle x(0)^2\rangle=\langle x(t)^2\rangle=\frac{k_{B} T}{m \psi} \quad \text { for all } 1 / 2<H<1\\
\mathrm{MSD}=\langle (x(t)-x(0))^2\rangle=2\langle x(t)^2\rangle-2\langle x(0) x(t)\rangle
$$
其中，$\tau=\left(\frac{\zeta \Gamma(2 H+1)}{m \psi}\right)^{1 /(2-2 H)} $.

其中$E_\gamma$为Mittag-Leffler函数$E_{\alpha,\beta}$，即有$
E_{\alpha}(z)=\sum_{k=0}^{\infty} z^{k} / \Gamma(\alpha k+1)$

### 梯度下降算法：各个曲线的参数结果

5s一族数据的最终的参数曲线和输入曲线间残差$<5\times 10^{-28}m^4$.其中p47两组参数结果如下图：

<img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.04图像\GLENII\5s\GLE-MSD p47_5s 2022.4.15 110.jpg" alt="GLE-MSD p47_5s 2022.4.15 110" style="zoom: 30%;" /><img src="C:\Users\zhouquan\OneDrive\research\DNA随机游走模拟\阶段报告2022.04图像\GLENII\5s\GLE-MSD p47_5s 2022.4.16 1616.jpg" alt="GLE-MSD p47_5s 2022.4.16 1616" style="zoom: 30%;" />

| 数据                       | 基因距离/kb | $m\cdot\psi$ | $\zeta$    | H       | 残差 |
| -------------------------- | ----------- | ------------ | ---------- | ------- | ------- |
| p47_5s                     | 47          | 6.7610e-08   | 8.8444e-07 | 0.59222 | 2.8855e-28 |
| p47_5s<br />(poor fitted)  | 47          | 4.6565e-08   | 2.0355e-07 | 0.78971 | 4.1641e-28 |
| p77_5s                     | 77          | 4.0195e-08   | 3.9200e-07 | 0.65705 | 1.6802e-28 |
| p179_5s                    | 179         | 2.0316e-08   | 3.0164e-07 | 0.69715 | 2.6247e-28 |
| n78_5s                     | 78          | 2.4082e-08   | 3.0383e-07 | 0.66254 | 3.3732e-28 |
| n142_5s                    | 142         | 2.6863e-08   | 2.9910e-07 | 0.69545 | 1.8208e-28 |
| p47_30s                    | 47          | 3.9944e-08   | 6.9486e-07 | 0.62257 | 1.7356e-29 |
| p77_30s                    | 77          | 3.9453e-08   | 6.2512e-07 | 0.60403 | 2.9051e-28 |
| p179_30s                   | 179         | 2.1505e-08   | 3.0016e-07 | 0.68269 | 2.8487e-28 |
| n78_30s | 78          | 2.1321e-08   | 4.8450e-07 | 0.63264 | 1.2434e-27 |
| n142_30s                   | 142         | 2.6389e-08 | 2.0004e-07 | 0.71073 | 1.5768e-28 |
| n589_30s                   | 589         | 1.20345e-08  | 3.7811e-07 | 0.64058 | 1.2475e-27 |
| p47_mix1 | 47 | 6.9048e-08 | 7.4100e-07 | 0.60198 | 1.253e-27 |
|p77_mix1| 77 |3.8741e-08|3.7712e-07|0.66775|2.641e-27|
| p179_mix1 | 179 | 2.138e-08|3.9254e-07|0.66717|4.1792e-27 |
| n78_mix1 | 78 |1.8551e-08|1.9734e-07|0.73156|9.1961e-27|
| n142_mix1 | 142 |2.5856e-08|2.9988e-07|0.69619|2.8891e-27|

mix1 中使用的数据删除差异10%以上的5s族数据，并在1200s处截断后续数据，残差取点为所有数据点

将上表中结果作图：

<img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220417151931863.png" alt="image-20220417151931863" style="zoom:25%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220417151948953.png" alt="image-20220417151948953" style="zoom:25%;" /><img src="C:\Users\zhouquan\AppData\Roaming\Typora\typora-user-images\image-20220417152005934.png" alt="image-20220417152005934" style="zoom:25%;" />

### MCMC算法及其结果

使用MCMC算法，不仅能给出参数拟合结果，也能同时给出误差。

数据由下表所示，并在下方附上图片：
| 数据                       | 基因距离/kb | $m\cdot\psi$ | $\zeta$    | H       |
| -------------------------- | ----------- | ------------ | ---------- | ------- |
| p47_mix1 | 47 | 6.87412195007807e-08 | 6.66202645703258e-07 | 0.613055937256195 |
|p77_mix1| 77 |3.73792586418892e-08|2.70154879131734e-07|0.702974565892393|
| p179_mix1 | 179 | 2.10648034296644e-08 |3.55007489206089e-07|0.677219161423908|
| n78_mix1 | 78 |1.78035267162928e-08|1.64558136979988e-07|0.750307382075805|
| n142_mix1 | 142 |2.58458067916738e-08|2.99339947011181e-07|0.696574713585549|
